{% if any_flagged %}
<div class="alert alert-danger mb-4">
  <strong>Warning:</strong> Your test was terminated due to suspicious tab
  switching. Cheating is not allowed during the test. Incomplete riddles have
  been marked with a score of 0.
</div>
{% endif %} {% extends 'base.html' %} {% block content %}
<div class="row">
  <div class="col-12">
    <div class="card shadow-lg mb-4">
      <div class="card-header bg-primary text-white">
        <h3 class="card-title mb-0">Your Results</h3>
      </div>
      <div class="card-body">
        <div class="text-center mb-4">
          <h4>Total Score: {{ total_score }} / {{ max_possible }}</h4>

          <div
            class="progress-bar bg-success"
            role="progressbar"
            style="width: 70%"
            aria-valuenow="{{ total_score }}"
            aria-valuemin="0"
            aria-valuemax="{{ max_possible }}"
          >
            {{ percentage_score }}%
          </div>
        </div>

        <div class="table-responsive">
          <table class="table table-striped table-bordered">
            <thead class="table-dark">
              <tr>
                <th>#</th>
                <th>Question</th>
                <th>Your Answer</th>
                <th>Status</th>
                <th>Hints Used</th>
                <th>Score</th>
              </tr>
            </thead>
            <tbody>
              {% for result in results %}
              <tr>
                <td>{{ loop.index }}</td>
                <td>{{ result.question }}</td>
                <td>
                  {% if result.completed %}
                  <span class="text-success">{{ result.answer_attempt }}</span>
                  {% elif result.answer_attempt %}
                  <span class="text-danger">{{ result.answer_attempt }}</span>
                  <small class="d-block text-muted"
                    >(Correct: {{ result.correct_answer }})</small
                  >
                  {% else %}
                  <span class="text-muted">Not attempted</span>
                  {% endif %}
                </td>
                <td>
                  {% if result.completed %}
                  <span class="badge bg-success">Completed</span>
                  {% else %}
                  <span class="badge bg-secondary">Incomplete</span>
                  {% endif %}
                </td>
                <td>
                  {% set hints_used = result.hint1_used + result.hint2_used +
                  result.hint3_used %} {% if hints_used > 0 %}
                  <span class="badge bg-warning text-dark"
                    >{{ hints_used }} hint{% if hints_used > 1 %}s{% endif %}
                    used</span
                  >
                  {% else %}
                  <span class="badge bg-info">No hints</span>
                  {% endif %}
                </td>
                <td>
                  {% if result.completed %}
                  <span class="badge bg-primary">{{ result.score }} / 10</span>
                  {% else %}
                  <span class="badge bg-secondary">0 / 10</span>
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <div class="text-center mt-4">
          <a href="{{ url_for('index') }}" class="btn btn-primary">
            <i class="fas fa-home me-2"></i>Return to Home
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
